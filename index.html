<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>MultiJuegos 10 - 2 Jugadores</title>
    <style>
        body { margin: 0; background: #1a1a1a; color: white; font-family: sans-serif; display: flex; flex-direction: column; align-items: center; }
        #menu { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-top: 20px; }
        button { padding: 15px; cursor: pointer; background: #444; color: white; border: none; border-radius: 5px; font-size: 16px; }
        button:hover { background: #666; }
        canvas { background: #000; border: 4px solid #555; display: none; margin-top: 20px; }
        #ui { margin-top: 10px; text-align: center; }
        .instructions { font-size: 0.9em; color: #aaa; margin-top: 5px; }
        #backBtn { display: none; margin-top: 10px; background: #822; }
    </style>
</head>
<body>

    <h1>MultiJuegos 2P</h1>
    <div id="ui">
        <p id="status">Selecciona un minijuego</p>
        <div class="instructions">P1: WASD | P2: Flechas</div>
    </div>

    <div id="menu">
        <button onclick="startGame('sumo')">1. Sumo (Empujar)</button>
        <button onclick="startGame('race')">2. Carrera de Obstáculos</button>
        <button onclick="startGame('soccer')">3. Mini Fútbol</button>
        <button onclick="startGame('collect')">4. Recolector Rápido</button>
        <button onclick="startGame('tank')">5. Duelo de Disparos</button>
        <button onclick="startGame('tron')">6. Tron (Estelas)</button>
        <button onclick="startGame('balance')">7. No te Caigas</button>
        <button onclick="startGame('tag')">8. Atrapadas (La lleva)</button>
        <button onclick="startGame('size')">9. Crece y Aplasta</button>
        <button onclick="startGame('math')">10. Carrera Matemática (W/Up)</button>
    </div>

    <button id="backBtn" onclick="resetToMenu()">Volver al Menú</button>
    <canvas id="gameCanvas" width="600" height="400"></canvas>

<script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const status = document.getElementById('status');
    const menu = document.getElementById('menu');
    const backBtn = document.getElementById('backBtn');

    let currentGame = null;
    let gameInterval = null;
    let keys = {};

    window.addEventListener('keydown', e => keys[e.code] = true);
    window.addEventListener('keyup', e => keys[e.code] = false);

    const P1 = { x: 0, y: 0, w: 30, h: 30, color: '#3498db', score: 0, vx:0, vy:0, size: 20 };
    const P2 = { x: 0, y: 0, w: 30, h: 30, color: '#e74c3c', score: 0, vx:0, vy:0, size: 20 };

    function startGame(gameType) {
        menu.style.display = 'none';
        canvas.style.display = 'block';
        backBtn.style.display = 'block';
        currentGame = gameType;
        initGame();
        gameInterval = setInterval(update, 1000/60);
    }

    function resetToMenu() {
        clearInterval(gameInterval);
        menu.style.display = 'grid';
        canvas.style.display = 'none';
        backBtn.style.display = 'none';
        status.innerText = "Selecciona un minijuego";
    }

    function initGame() {
        P1.x = 100; P1.y = 200; P1.vx = 0; P1.vy = 0; P1.size = 25;
        P2.x = 500; P2.y = 200; P2.vx = 0; P2.vy = 0; P2.size = 25;
        if(currentGame === 'tron') { P1.trail = []; P2.trail = []; P1.dir = 'R'; P2.dir = 'L'; }
        if(currentGame === 'collect') { target = {x: 300, y: 200}; }
        if(currentGame === 'math') { mathTask = generateMath(); P1.y = 350; P2.y = 350; }
        status.innerText = `Jugando: ${currentGame.toUpperCase()}`;
    }

    let target = {x: 300, y: 200};
    let mathTask = "";

    function update() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        // Movimiento básico para la mayoría de juegos
        const speed = 4;
        if(keys['KeyW']) P1.y -= speed; if(keys['KeyS']) P1.y += speed;
        if(keys['KeyA']) P1.x -= speed; if(keys['KeyD']) P1.x += speed;
        if(keys['ArrowUp']) P2.y -= speed; if(keys['ArrowDown']) P2.y += speed;
        if(keys['ArrowLeft']) P2.x -= speed; if(keys['ArrowRight']) P2.x += speed;

        switch(currentGame) {
            case 'sumo': 
                drawCircle(P1); drawCircle(P2);
                let dx = P1.x - P2.x; let dy = P1.y - P2.y;
                let dist = Math.sqrt(dx*dx + dy*dy);
                if(dist < P1.size + P2.size) { P1.x += dx/5; P1.y += dy/5; P2.x -= dx/5; P2.y -= dy/5; }
                if(P1.x < 0 || P1.x > 600 || P1.y < 0 || P1.y > 400) win("Jugador 2");
                if(P2.x < 0 || P2.x > 600 || P2.y < 0 || P2.y > 400) win("Jugador 1");
                break;

            case 'collect':
                drawCircle(P1); drawCircle(P2);
                ctx.fillStyle = "yellow"; ctx.beginPath(); ctx.arc(target.x, target.y, 10, 0, Math.PI*2); ctx.fill();
                if(Math.hypot(P1.x-target.x, P1.y-target.y) < 20) { target.x = Math.random()*580; target.y = Math.random()*380; P1.score++; }
                if(Math.hypot(P2.x-target.x, P2.y-target.y) < 20) { target.x = Math.random()*580; target.y = Math.random()*380; P2.score++; }
                status.innerText = `P1: ${P1.score} | P2: ${P2.score}`;
                if(P1.score > 10) win("Jugador 1"); if(P2.score > 10) win("Jugador 2");
                break;

            case 'tron':
                P1.trail.push({x: P1.x, y: P1.y}); P2.trail.push({x: P2.x, y: P2.y});
                P1.trail.forEach(t => ctx.fillRect(t.x, t.y, 5, 5));
                P2.trail.forEach(t => ctx.fillRect(t.x, t.y, 5, 5));
                // Lógica simplificada: si tocas bordes pierdes
                if(P1.x < 0 || P1.x > 600 || P1.y < 0 || P1.y > 400) win("Jugador 2");
                if(P2.x < 0 || P2.x > 600 || P2.y < 0 || P2.y > 400) win("Jugador 1");
                break;

            case 'soccer':
                drawRect(P1); drawRect(P2);
                ctx.fillStyle = "white"; ctx.fillRect(target.x, target.y, 15, 15); // La pelota
                target.x += (target.x - P1.x < 20 && Math.abs(target.y-P1.y)<30) ? 5 : 0;
                target.x -= (P2.x - target.x < 20 && Math.abs(target.y-P2.y)<30) ? 5 : 0;
                if(target.x < 0) win("Jugador 2"); if(target.x > 600) win("Jugador 1");
                break;

            case 'math':
                ctx.font = "30px Arial"; ctx.fillStyle = "white"; ctx.fillText(mathTask.q, 250, 100);
                drawCircle(P1); drawCircle(P2);
                if(keys['KeyW']) { if(mathTask.a === 'W') win("Jugador 1"); else P1.y = 350; }
                if(keys['ArrowUp']) { if(mathTask.a === 'U') win("Jugador 2"); else P2.y = 350; }
                break;
            
            default:
                drawCircle(P1); drawCircle(P2);
                break;
        }
    }

    function drawCircle(p) { ctx.fillStyle = p.color; ctx.beginPath(); ctx.arc(p.x, p.y, p.size, 0, Math.PI*2); ctx.fill(); }
    function drawRect(p) { ctx.fillStyle = p.color; ctx.fillRect(p.x, p.y, 30, 30); }

    function generateMath() {
        return { q: "Pulsa tu tecla ARRIBA rápido!", a: Math.random() > 0.5 ? 'W' : 'U' };
    }

    function win(player) {
        alert(player + " gana!");
        P1.score = 0; P2.score = 0;
        resetToMenu();
    }
</script>
</body>
</html>
